import{ap as R,ae as T,ai as A,r as h,ah as L,j as e,h as b,ad as v,B as j,T as l,l as c,af as M,n as H,D as p,am as z}from"./index-C2iXY8ra.js";import{a as G}from"./apiClient-CqGJZrRH.js";import{u as $}from"./notificationSnackbar-D5H_8dBm.js";import{S as O}from"./Stack-Blh1MSla.js";import{S as k,A as D}from"./Skeleton-D2-GEIGL.js";import{C as w,S as B}from"./Save-vqwcxNV7.js";import{C as V}from"./Card-bXk435uA.js";import{G as r}from"./Grid-C4VPN10G.js";import{T as a}from"./TextField-DwwPb3TO.js";import"./useFormControl-CM1PNU5y.js";function ie(){var W;const{id:m}=R(),x=T(),N=A(),{showNotification:d}=$(),[q,J]=h.useState(!1),[C,y]=h.useState(!1),[u,F]=h.useState(null),[t,E]=h.useState({}),g=L(i=>i.culte);h.useEffect(()=>{if(m&&g.length>0){const i=parseInt(m,10),o=g.find(s=>s.idCulte===i);if(o){F(o);const s={...o};E(s)}else d("culte non trouvé","error"),x("/cultes")}},[m,g,x,d]);const n=i=>{const{name:o,value:s}=i.target;E(f=>({...f,[o]:s}))},I=async()=>{var i,o;if(!(!u||!u.idCulte)){if(!((i=t.typeCulte)!=null&&i.trim())){d("Le type de culte est requis","warning");return}if(!((o=t.dateCulte)!=null&&o.trim())){d("La date du culte est requise","warning");return}try{y(!0);const s={...t,idCulte:u.idCulte,typeCulte:t.typeCulte?Number(t.typeCulte):null};console.log("Données à envoyer:",s);const f=await G.updateCulte(s);f.status===1?(N(z(f.data)),d("Culte modifié avec succès","success"),x(`/detailculte/${m}`)):d("Erreur lors de la modification du culte","error")}catch(s){console.error("Error updating culte:",s),d("Erreur lors de la modification","error")}finally{y(!1)}}},P=()=>{x(`/detailculte/${m}`)},S=()=>{x("/culte")};return q?e.jsx(b,{children:e.jsx(v,{maxWidth:"lg",children:e.jsxs(O,{spacing:3,children:[e.jsx(k,{variant:"rectangular",height:56}),e.jsx(k,{variant:"rectangular",height:400})]})})}):u?e.jsx(b,{children:e.jsxs(v,{maxWidth:"lg",children:[e.jsxs(j,{mb:3,display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(c,{startIcon:e.jsx(D,{}),onClick:S,children:"Retour à la liste"}),e.jsxs(j,{children:[e.jsx(c,{variant:"outlined",startIcon:e.jsx(w,{}),onClick:P,sx:{mr:2},children:"Annuler"}),e.jsx(c,{variant:"contained",startIcon:e.jsx(B,{}),onClick:I,disabled:C,children:C?"Enregistrement...":"Enregistrer"})]})]}),e.jsx(l,{variant:"h4",gutterBottom:!0,children:"Modifier le culte"}),e.jsxs(l,{variant:"body1",color:"text.secondary",paragraph:!0,children:["Modifiez les informations du culte du ",u==null?void 0:u.dateCulte," (",u.typeCulte,")"]}),e.jsx(V,{sx:{p:3,mb:3},children:e.jsxs(r,{container:!0,spacing:3,children:[e.jsx(r,{item:!0,xs:12,sm:6,md:4,children:e.jsx(a,{fullWidth:!0,select:!0,label:"Type de culte *",name:"typeCulte",value:t.typeCulte||"",onChange:n,required:!0,children:(W=M)==null?void 0:W.map(i=>e.jsx(H,{value:i.value,children:i.label},i.value))})}),e.jsx(r,{item:!0,xs:12,sm:6,md:4,children:e.jsx(a,{fullWidth:!0,type:"date",label:"Date du culte *",name:"dateCulte",value:t.dateCulte||"",onChange:n,InputLabelProps:{shrink:!0},required:!0})}),e.jsx(r,{item:!0,xs:12,sm:6,md:4,children:e.jsx(a,{fullWidth:!0,label:"Dirigeant",name:"dirigeant",value:t.dirigeant||"",onChange:n})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(p,{sx:{my:2},children:e.jsx(l,{variant:"h6",children:"Prédication"})})}),e.jsx(r,{item:!0,xs:12,sm:6,md:4,children:e.jsx(a,{fullWidth:!0,label:"Thème de la prédication",name:"themePredication",value:t.themePredication||"",onChange:n})}),e.jsx(r,{item:!0,xs:12,sm:6,md:4,children:e.jsx(a,{fullWidth:!0,label:"Passage biblique",name:"passageBiblique",value:t.passageBiblique||"",onChange:n})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(a,{fullWidth:!0,label:"Prédication",name:"predication",value:t.predication||"",onChange:n,multiline:!0,rows:2})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(p,{sx:{my:2},children:e.jsx(l,{variant:"h6",children:"Participants"})})}),e.jsx(r,{item:!0,xs:12,sm:6,md:4,children:e.jsx(a,{fullWidth:!0,type:"number",label:"Nombre d'hommes",name:"nombreHommeCulte",value:t.nombreHommeCulte||"",onChange:n,InputProps:{inputProps:{min:0}}})}),e.jsx(r,{item:!0,xs:12,sm:6,md:4,children:e.jsx(a,{fullWidth:!0,type:"number",label:"Nombre de femmes",name:"nombreFemmeCulte",value:t.nombreFemmeCulte||"",onChange:n,InputProps:{inputProps:{min:0}}})}),e.jsx(r,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(j,{sx:{p:2,bgcolor:"grey.50",borderRadius:1},children:[e.jsx(l,{variant:"subtitle2",color:"text.secondary",children:"Total participants"}),e.jsx(l,{variant:"h5",color:"primary",children:(Number(t.nombreHommeCulte)||0)+(Number(t.nombreFemmeCulte)||0)})]})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(p,{sx:{my:2},children:e.jsx(l,{variant:"h6",children:"Ecodim"})})}),e.jsx(r,{item:!0,xs:12,sm:6,md:4,children:e.jsx(a,{fullWidth:!0,type:"number",label:"Ecodim",name:"ecodim",value:t.ecodim||"",onChange:n})}),t.ecodim==="1"&&e.jsx(r,{item:!0,xs:12,sm:6,md:4,children:e.jsx(a,{fullWidth:!0,type:"number",label:"Fille Ecodim",name:"filleEcodim",value:t.filleEcodim||"",onChange:n})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(p,{sx:{my:2},children:e.jsx(l,{variant:"h6",children:"Résumé de la prédication"})})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(a,{fullWidth:!0,label:"Résumé de la prédication",name:"resumePredication",value:t.resumePredication||"",onChange:n,multiline:!0,rows:6,placeholder:"Résumez les points principaux de la prédication..."})}),e.jsxs(r,{item:!0,xs:12,children:[e.jsx(p,{sx:{my:2}}),e.jsxs(j,{display:"flex",justifyContent:"flex-end",gap:2,children:[e.jsx(c,{variant:"outlined",startIcon:e.jsx(w,{}),onClick:P,children:"Annuler"}),e.jsx(c,{variant:"contained",startIcon:e.jsx(B,{}),onClick:I,disabled:C,children:C?"Enregistrement...":"Enregistrer les modifications"})]})]})]})})]})}):e.jsx(b,{children:e.jsx(v,{maxWidth:"lg",children:e.jsxs(j,{textAlign:"center",py:10,children:[e.jsx(l,{variant:"h5",color:"text.secondary",gutterBottom:!0,children:"Culte non trouvé"}),e.jsx(c,{variant:"contained",startIcon:e.jsx(D,{}),onClick:S,children:"Retour à la liste"})]})})})}export{ie as CulteEditView,ie as default};
